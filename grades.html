// in grades.html (or index.html) …
async function fetchAll() {
  const token = document.getElementById("token").value.trim();
  const resultsContainer = document.getElementById("results");
  resultsContainer.innerHTML = "";

  if (!token) {
    resultsContainer.textContent = "Paste your token first!";
    return;
  }

  try {
    const resp = await fetch(
      "https://canvas-proxy–<your-deployment-url>/api/grades",
      {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ token }),
      }
    );
    if (!resp.ok) {
      throw new Error("Proxy returned " + resp.status);
    }
    const data = await resp.json();
    // data will be an array like:
    // [
    //   { course_id: 34917, course_name: "Italian II-Caprio", final_grade: "92", final_score: "92.0" },
    //   { ... }
    // ]
    data.forEach((c) => {
      const div = document.createElement("div");
      div.innerHTML = `
        <h3>${c.course_name} (ID: ${c.course_id})</h3>
        <p>Final Grade: <span style="color: green">${c.final_grade}</span>
           (Score: ${c.final_score})</p>
      `;
      resultsContainer.appendChild(div);
    });
  } catch (err) {
    console.error(err);
    resultsContainer.textContent = "Fetch failed: " + err.message;
  }
}
